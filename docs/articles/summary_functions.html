<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Summary Functions • rCISSVAE</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summary Functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rCISSVAE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CISS-VAE/rCISS-VAE" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Summary Functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CISS-VAE/rCISS-VAE/blob/HEAD/vignettes/summary_functions.rmd" class="external-link"><code>vignettes/summary_functions.rmd</code></a></small>
      <div class="d-none name"><code>summary_functions.rmd</code></div>
    </div>

    
    
<p>There are two summary functions included with the rCISSVAE package
that can help visualize the data clusters and model suitability to the
data.</p>
<div class="section level2">
<h2 id="per-cluster-summary">Per-cluster Summary<a class="anchor" aria-label="anchor" href="#per-cluster-summary"></a>
</h2>
<p>The <code>cluster_summary()</code> function creates a data summary
table stratified by missingness cluster. Use the <code>cont_style</code>
param to set the style of continuous variable summaries (“mean_sd”,
“median_iqr”, “both”).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.6.0</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 4.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.0</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.2.0     </span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ciss-vae.github.io/rCISS-VAE">rCISSVAE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'kableExtra'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group_rows</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary" class="external-link">gtsummary</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_missing</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cluster_summary</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_missing</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span>, </span>
<span>include <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_missing</span><span class="op">)</span>, <span class="st">"index"</span><span class="op">)</span>, </span>
<span>statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{mean} ({sd})"</span>,</span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_categorical</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{n} / {N}\n ({p}%)"</span><span class="op">)</span>, </span>
<span>  missing <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span>  </span></code></pre></div>
<p>|<strong>Characteristic</strong> |<strong>N</strong>
|<strong>0</strong><br>
N = 2,000 |<strong>1</strong><br>
N = 2,000 |<strong>2</strong><br>
N = 2,000 |<strong>3</strong><br>
N = 2,000 | |:——————|:—–|:—————-|:—————-|:—————-|:—————-| |Age |8,000
|10.10 (2.04) |10.19 (2.08) |10.21 (2.14) |10.29 (2.06) | |Unknown |NA
|0 |0 |0 |0 | |Salary |8,000 |5.81 (0.61) |5.83 (0.62) |5.83 (0.61)
|5.81 (0.60) | |Unknown |NA |0 |0 |0 |0 | |ZipCode10001 |8,000 |646 /
2,000 (32%) |674 / 2,000 (34%) |663 / 2,000 (33%) |645 / 2,000 (32%) |
|Unknown |NA |0 |0 |0 |0 | |ZipCode20002 |8,000 |703 / 2,000 (35%) |652
/ 2,000 (33%) |655 / 2,000 (33%) |687 / 2,000 (34%) | |Unknown |NA |0 |0
|0 |0 | |ZipCode30003 |8,000 |651 / 2,000 (33%) |674 / 2,000 (34%) |682
/ 2,000 (34%) |668 / 2,000 (33%) | |Unknown |NA |0 |0 |0 |0 | |Y11
|4,878 |-21 (10) |-16 (9) |8 (5) |-3 (6) | |Unknown |NA |1,281 |1,288 |0
|553 | |Y12 |4,882 |69 (11) |-26 (9) |55 (6) |-24 (8) | |Unknown |NA
|1,264 |1,283 |0 |571 | |Y13 |4,890 |77 (12) |-25 (9) |98 (12) |-17 (7)
| |Unknown |NA |1,289 |1,264 |0 |557 | |Y14 |4,871 |73 (12) |-21 (8)
|125 (16) |-11 (6) | |Unknown |NA |1,300 |1,283 |0 |546 | |Y15 |4,859
|76 (12) |-12 (6) |141 (19) |-14 (6) | |Unknown |NA |1,273 |1,293 |0
|575 | |Y21 |4,865 |-33 (12) |-28 (11) |1 (7) |-12 (7) | |Unknown |NA
|1,266 |1,292 |0 |577 | |Y22 |4,906 |69 (12) |-40 (12) |54 (6) |-36 (10)
| |Unknown |NA |1,266 |1,276 |0 |552 | |Y23 |4,902 |79 (13) |-38 (11)
|104 (13) |-29 (9) | |Unknown |NA |1,273 |1,275 |0 |550 | |Y24 |4,854
|75 (12) |-32 (10) |135 (18) |-22 (7) | |Unknown |NA |1,302 |1,287 |0
|557 | |Y25 |4,894 |78 (13) |-22 (8) |153 (21) |-25 (8) | |Unknown |NA
|1,257 |1,294 |0 |555 | |Y31 |5,933 |-18 (10) |-13 (9) |13 (5) |1 (6) |
|Unknown |NA |192 |1,285 |0 |590 | |Y32 |5,944 |74 (11) |-24 (10) |62
(7) |-21 (8) | |Unknown |NA |206 |1,287 |0 |563 | |Y33 |5,987 |84 (13)
|-23 (10) |108 (13) |-14 (7) | |Unknown |NA |203 |1,267 |0 |543 | |Y34
|5,949 |81 (13) |-17 (8) |136 (17) |-7 (6) | |Unknown |NA |195 |1,275 |0
|581 | |Y35 |5,946 |83 (13) |-8 (6) |153 (20) |-10 (7) | |Unknown |NA
|204 |1,285 |0 |565 | |Y41 |5,968 |-8 (4) |-5 (3) |6 (2) |1 (2) |
|Unknown |NA |184 |1,279 |0 |569 | |Y42 |5,978 |35 (6) |-11 (4) |29 (4)
|-9 (3) | |Unknown |NA |199 |1,282 |0 |541 | |Y43 |5,987 |39 (7) |-10
(3) |49 (6) |-6 (3) | |Unknown |NA |217 |1,242 |0 |554 | |Y44 |5,977 |37
(7) |-8 (3) |62 (9) |-3 (2) | |Unknown |NA |186 |1,280 |0 |557 | |Y45
|5,914 |39 (7) |-4 (3) |70 (10) |-5 (2) | |Unknown |NA |204 |1,305 |0
|577 | |Y51 |5,923 |-5.4 (3.6) |-2.9 (3.0) |6.9 (1.9) |2.5 (2.0) |
|Unknown |NA |222 |1,279 |0 |576 | |Y52 |5,966 |32 (5) |-8 (3) |26 (3)
|-6 (3) | |Unknown |NA |209 |1,283 |0 |542 | |Y53 |6,024 |35 (6) |-6 (3)
|44 (6) |-3 (2) | |Unknown |NA |184 |1,243 |0 |549 | |Y54 |5,953 |34 (6)
|-5 (3) |55 (7) |-1 (2) | |Unknown |NA |217 |1,281 |0 |549 | |Y55 |5,950
|35 (6) |-2 (2) |62 (9) |-2 (2) | |Unknown |NA |207 |1,292 |0 |551 |</p>
</div>
<div class="section level2">
<h2 id="by-cluster-mse-function">By-cluster MSE function<a class="anchor" aria-label="anchor" href="#by-cluster-mse-function"></a>
</h2>
<p>After running the model, you can get the per-cluster validation set
MSE using the <code>get_mse()</code> function. Set
‘return_validation_dataset = TRUE’ in the <code><a href="../reference/run_cissvae.html">run_cissvae()</a></code>
function to be able to use get_mse on the result object. If the
validation dataset (val_data in result object) and imputed validation
dataset (val_imputed in the result object) are not returned, the MSE
cannot be calculated.</p>
<p>If the <code><a href="../reference/run_cissvae.html">run_cissvae()</a></code> function was used to generate
clusters, set <code>return_clusters=TRUE</code> and the clusters will be
part of the return object. Otherwise, use the ‘clusters’ parameter in
<code>get_mse()</code> to input the clusters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="../reference/run_cissvae.html">run_cissvae</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_missing</span>,</span>
<span>  index_col <span class="op">=</span> <span class="st">"index"</span>,</span>
<span>  val_proportion <span class="op">=</span> <span class="fl">0.1</span>, <span class="co">## pass a vector for different proportions by cluster</span></span>
<span>  columns_ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Salary"</span>, <span class="st">"ZipCode10001"</span>, <span class="st">"ZipCode20002"</span>, <span class="st">"ZipCode30003"</span><span class="op">)</span>, <span class="co">## If there are columns in addition to the index you want to ignore when selecting validation set, list them here. In this case, we ignore the 'demographic' columns because we do not want to remove data from them for validation purposes. </span></span>
<span>  clusters <span class="op">=</span> <span class="va">clusters</span><span class="op">$</span><span class="va">clusters</span>, <span class="co">## we have precomputed cluster labels so we pass them here</span></span>
<span>  epochs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  return_silhouettes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_history <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Get detailed training history</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_model <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">## Allows for plotting model schematic</span></span>
<span>  device <span class="op">=</span> <span class="st">"cpu"</span>,  <span class="co"># Explicit device selection</span></span>
<span>  layer_order_enc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unshared"</span>, <span class="st">"shared"</span>, <span class="st">"unshared"</span><span class="op">)</span>,</span>
<span>  layer_order_dec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shared"</span>, <span class="st">"unshared"</span>, <span class="st">"shared"</span><span class="op">)</span>,</span>
<span>  return_validation_dataset <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Cluster dataset:</span></span>
<span><span class="co">##  ClusterDataset(n_samples=8000, n_features=30, n_clusters=4)</span></span>
<span><span class="co">##   • Original missing: 61800 / 200000 (30.90%)</span></span>
<span><span class="co">##   • Validation held-out: 13783 (9.97% of non-missing)</span></span>
<span><span class="co">##   • .data shape:     (8000, 30)</span></span>
<span><span class="co">##   • .masks shape:    (8000, 30)</span></span>
<span><span class="co">##   • .val_data shape: (8000, 30)</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Check necessary returns:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Check necessary returns: imputed_dataset, raw_data, model, cluster_dataset, training_history, val_data, val_imputed</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">get_mse</span><span class="op">(</span>res <span class="op">=</span> <span class="va">result</span>, </span>
<span>  group_col <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  clusters <span class="op">=</span> <span class="va">clusters</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span>  feature_cols <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">## default, all numeric columns excluding group_col &amp; cols_ignore</span></span>
<span>  by_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  by_cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cols_ignore <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"index"</span>, <span class="st">"Age"</span>, <span class="st">"Salary"</span>, <span class="st">"ZipCode10001"</span>, <span class="st">"ZipCode20002"</span>, <span class="st">"ZipCode30003"</span><span class="op">)</span> <span class="co">## columns to not score</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Overall MSE for validation data: 140.0841</span></span></code></pre>
<pre><code><span><span class="co">## $overall</span></span>
<span><span class="co">##        mse     n</span></span>
<span><span class="co">## 1 140.0841 13783</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $per_cluster</span></span>
<span><span class="co">##   cluster       mse    n</span></span>
<span><span class="co">## 1       0  85.45211 3408</span></span>
<span><span class="co">## 2       1 180.51999 1787</span></span>
<span><span class="co">## 3       2 193.24880 5000</span></span>
<span><span class="co">## 4       3  97.74949 3588</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yasin Khadem Charvadeh, Danielle Vaithilingam, Kenneth Seier, Katherine S. Panageas, Mithat Gönen, Yuan Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
