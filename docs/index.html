<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Clustering-Informed Shared-Structure Variational Autoencoder (CISS-VAE) for Missing Data Imputation • rCISSVAE</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Clustering-Informed Shared-Structure Variational Autoencoder (CISS-VAE) for Missing Data Imputation">
<meta name="description" content="Implements the Clustering-Informed Shared-Structure Variational Autoencoder (CISS-VAE), a deep learning framework for missing data imputation introduced in Khadem Charvadeh et al. (2025) &lt;doi:10.1002/sim.70335&gt;. The model accommodates all three types of missing data mechanisms: Missing Completely At Random (MCAR), Missing At Random (MAR), and Missing Not At Random (MNAR). While it is particularly well-suited to MNAR scenarios, where missingness patterns carry informative signals, CISS-VAE also functions effectively under MAR assumptions.">
<meta property="og:description" content="Implements the Clustering-Informed Shared-Structure Variational Autoencoder (CISS-VAE), a deep learning framework for missing data imputation introduced in Khadem Charvadeh et al. (2025) &lt;doi:10.1002/sim.70335&gt;. The model accommodates all three types of missing data mechanisms: Missing Completely At Random (MCAR), Missing At Random (MAR), and Missing Not At Random (MNAR). While it is particularly well-suited to MNAR scenarios, where missingness patterns carry informative signals, CISS-VAE also functions effectively under MAR assumptions.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rCISSVAE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CISS-VAE/rCISS-VAE" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ciss-vae.readthedocs.io/en/latest/index.html" aria-label="CISS-VAE"><span class="filetype filetype-py"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rciss-vae">rCISS-VAE<a class="anchor" aria-label="anchor" href="#rciss-vae"></a>
</h1></div>
<p>This is the R implementation of the Clustering-Informed Shared-Structure Variational Autoencoder (CISS-VAE) for imputation. The Python implementation can be found <a href="https://github.com/CISS-VAE/CISS-VAE-python" class="external-link">here</a> and is available for installation on <a href="https://pypi.org/project/CISS-VAE/" class="external-link">PyPI</a>.</p>
<p>CISS-VAE is a flexible deep learning model for missing data imputation that accommodates all three types of missing data mechanisms: Missing Completely At Random (MCAR), Missing At Random (MAR), and Missing Not At Random (MNAR). While it is particularly well-suited to MNAR scenarios where missingness patterns carry informative signals, CISS-VAE also functions effectively under MAR assumptions. For more information, please check out our <a href="https://doi.org/10.1002/sim.70335" class="external-link">publication</a>!</p>
<img src="reference/figures/CISSVAEModelDiagram.png" alt="Example CISS-VAE for Imputation Workflow"><br><details style="background: #deeff7ff; border: #2A373D; color: black; border-radius: 10px"><summary><span style="color: #2A373D"><b>Click Here for More Information</b></span>
</summary><div style="padding: 10px 10px 10px 10px">
<p>A key feature of CISS-VAE is the use of unsupervised clustering to capture distinct patterns of missingness. Alongside cluster-specific representations, the method leverages shared encoder and decoder layers. This allows for knowledge transfer across clusters and enhances parameter stability, which is especially important when some clusters have small sample sizes. In situations where the data do not naturally partition into meaningful clusters, the model defaults to a pooled representation, preventing unnecessary complications from cluster-specific components. <br><br></p>
Additionally, CISS-VAE incorporates an iterative learning procedure, with a validation-based convergence criterion recommended to avoid overfitting. This procedure significantly improves imputation accuracy compared to traditional Variational Autoencoder training approaches in the presence of missing values. Overall, CISS-VAE adapts across a range of missing data mechanisms, leveraging clustering only when it offers clear benefits, and delivering robust, accurate imputations under varying conditions of missingness.
</div>
</details><div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install devtools or remotes if not already installed:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre></div>
<p>The rCISSVAE package can be installed with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"CISS-VAE/rCISS-VAE"</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"CISS-VAE/rCISS-VAE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ensuring-correct-virtual-environment-for-reticulate">Ensuring correct virtual environment for reticulate<a class="anchor" aria-label="anchor" href="#ensuring-correct-virtual-environment-for-reticulate"></a>
</h2>
<p>This package uses <code>reticulate</code> to interface with the python version of the package <code>ciss-vae</code>, which can be installed via pip.</p>
<p>If you are comfortable creating a venv or conda environment and installing the package, great! Then all you need to do is tell reticulate where to point.</p>
<p><strong>For Venv</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_virtualenv</a></span><span class="op">(</span><span class="st">"./.venv"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>For conda</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_condaenv</a></span><span class="op">(</span><span class="st">"myenv"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="virtual-environment-helper-function">Virtual environment helper function<a class="anchor" aria-label="anchor" href="#virtual-environment-helper-function"></a>
</h3>
<p>If you do not want to manually create the virtual environment, you can use the helper function <code><a href="reference/create_cissvae_env.html">create_cissvae_env()</a></code> to create a virtual environment (venv).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/create_cissvae_env.html">create_cissvae_env</a></span><span class="op">(</span></span>
<span>  envname <span class="op">=</span> <span class="st">"cissvae_environment"</span>, <span class="co">## name of environment</span></span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">## add path to wherever you want virtual environment to be. If null will create environment in current working directory</span></span>
<span>  install_python <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">## set to TRUE if you want create_cisssvae_env to install python for you</span></span>
<span>  python_version <span class="op">=</span> <span class="st">"3.10"</span> <span class="co">## set to whatever version you want &gt;=3.10. Python 3.10 or 3.11 recommended</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once the environment is created, activate it using:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_virtualenv</a></span><span class="op">(</span><span class="st">"./cissvae_environment"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In other words,</span></span>
<span><span class="co"># reticulate::use_virtualenv("./your_environment_name", required = TRUE)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quickstart">Quickstart<a class="anchor" aria-label="anchor" href="#quickstart"></a>
</h2>
<p>The input dataset should be a <code>matrix</code> or <code>data.frame</code> and missing values should be represented with <code>NA</code> or <code>NaN</code>. Precomputed clusters should be passed as a numeric vector of length ‘n’ for an ‘n x p’ dataset. For more information on having <code><a href="reference/run_cissvae.html">run_cissvae()</a></code> handle the clustering see the <a href="https://ciss-vae.github.io/rCISS-VAE/articles/vignette.html#clustering-features-by-missingness-patterns">‘Clustering Features by Missingness Patterns’ vignette</a>.</p>
<p>```{r}</p>
<p>library(reticulate) library(rCISSVAE)</p>
<p>data(df_missing) data(clusters)</p>
<p>dat = run_cissvae( data = df_missing, index_col = “index”, val_proportion = 0.1, ## pass a vector for different proportions by cluster columns_ignore = c(“Age”, “Salary”, “ZipCode10001”, “ZipCode20002”, “ZipCode30003”), ## If there are columns in addition to the index you want to ignore when selecting validation set, list them here. In this case, we ignore the ‘demographic’ columns because we do not want to remove data from them for validation purposes. clusters = clusters$clusters, ## we have precomputed cluster labels so we pass them here epochs = 5, return_silhouettes = FALSE, return_history = TRUE, # Get detailed training history verbose = FALSE, return_model = TRUE, ## Allows for plotting model schematic device = “cpu”, # Explicit device selection layer_order_enc = c(“unshared”, “shared”, “unshared”), layer_order_dec = c(“shared”, “unshared”, “shared”), latent_shared = FALSE, output_shared = FALSE )</p>
<p>plot_vae_architecture(model = dat$model) ```</p>
<div class="float">
<img src="reference/figures/test_plot_arch.png" alt="Architecture diagram produced by plot_vae_architecture"><div class="figcaption"><strong>Architecture of Above Model</strong></div>
</div>
<p>For a full tutorial, see <a href="https://ciss-vae.github.io/rCISS-VAE/articles/vignette.html">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use our package in your research, please consider citing <a href="https://doi.org/10.1002/sim.70335" class="external-link">our recent publication!</a></p>
<blockquote>
<p>Y. Khadem Charvadeh, K. Seier, K. S. Panageas, D. Vaithilingam, M.Gönen, and Y. Chen, “Clustering-Informed Shared-Structure Variational Autoencoder for Missing Data Imputation in Large-Scale Healthcare Data,” Statistics in Medicine 44, no. 28-30 (2025): e70335, <a href="https://doi.org/10.1002/sim.70335" class="external-link uri">https://doi.org/10.1002/sim.70335</a>.</p>
</blockquote>
<div class="section level3">
<h3 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h3>
<blockquote>
<ul>
<li>Yasin Khadem Charvadeh</li>
<li>Kenneth Seier<br>
</li>
<li>Katherine S. Panageas<br>
</li>
<li>Danielle Vaithilingam</li>
<li>Mithat Gönen<br>
</li>
<li>
<b>Yuan Chen <i>(corresponding author)</i></b> — <a href="mailto:cheny19@mskcc.org" class="email">cheny19@mskcc.org</a>
</li>
</ul>
</blockquote>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/CISS-VAE/rCISS-VAE/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/CISS-VAE/rCISS-VAE/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rCISSVAE</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yasin Khadem Charvadeh <br><small class="roles"> Author </small>   </li>
<li>Kenneth Seier <br><small class="roles"> Author </small>   </li>
<li>Katherine S. Panageas <br><small class="roles"> Author </small>   </li>
<li>Danielle Vaithilingam <br><small class="roles"> Author, maintainer </small>   </li>
<li>Mithat Gönen <br><small class="roles"> Author </small>   </li>
<li>Yuan Chen <br><small class="roles"> Author </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yasin Khadem Charvadeh, Kenneth Seier, Katherine S. Panageas, Danielle Vaithilingam, Mithat Gönen, Yuan Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
