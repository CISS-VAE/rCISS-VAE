% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ciss_vae.R
\name{run_cissvae}
\alias{run_cissvae}
\title{Run the CISS-VAE pipeline (letting Python choose device)}
\usage{
run_cissvae(
  data,
  index_col = NULL,
  val_percent = 0.1,
  replacement_value = 0,
  columns_ignore = NULL,
  print_dataset = TRUE,
  clusters = NULL,
  n_clusters = NULL,
  cluster_selection_epsilon = 0.25,
  seed = 42,
  hidden_dims = c(150, 120, 60),
  latent_dim = 15,
  layer_order_enc = c("unshared", "unshared", "unshared"),
  layer_order_dec = c("shared", "shared", "shared"),
  latent_shared = FALSE,
  output_shared = FALSE,
  batch_size = 4000,
  return_model = TRUE,
  epochs = 500,
  initial_lr = 0.01,
  decay_factor = 0.999,
  beta = 0.001,
  max_loops = 100,
  patience = 2,
  epochs_per_loop = NULL,
  initial_lr_refit = NULL,
  decay_factor_refit = NULL,
  beta_refit = NULL,
  verbose = FALSE,
  return_silhouettes = FALSE
)
}
\arguments{
\item{data}{A data.frame or matrix (samples Ã— features), may contain \code{NA}.}

\item{index_col}{Character. Column in \code{data} to treat as sample ID; removed before training and re-attached. Default \code{NULL}.}

\item{val_percent}{Numeric fraction of non-missing entries to hold out. Default \code{0.1}.}

\item{replacement_value}{Numeric fill value for masked entries. Default \code{0.0}.}

\item{columns_ignore}{Character or integer vector of columns to ignore. Default \code{NULL}.}

\item{print_dataset}{Logical; if \code{TRUE}, prints dataset summary. Default \code{TRUE}.}

\item{clusters}{Optional vector (or single-column data.frame) of precomputed cluster labels. Default \code{NULL}.}

\item{n_clusters}{Integer for KMeans if \code{clusters} is \code{NULL}. Default \code{NULL}.}

\item{cluster_selection_epsilon}{Numeric epsilon for HDBSCAN. Default \code{0.25}.}

\item{seed}{Integer random seed. Default \code{42}.}

\item{hidden_dims}{Integer vector of hidden layer sizes. Default \code{c(150,120,60)}.}

\item{latent_dim}{Integer latent space dimension. Default \code{15}.}

\item{layer_order_enc}{Character vector for encoder layer sharing. Default \code{c("unshared","unshared","unshared")}.}

\item{layer_order_dec}{Character vector for decoder layer sharing. Default \code{c("shared","shared","shared")}.}

\item{latent_shared}{Logical; share latent weights? Default \code{FALSE}.}

\item{output_shared}{Logical; share output weights? Default \code{FALSE}.}

\item{batch_size}{Integer batch size. Default \code{4000}.}

\item{return_model}{Logical; if \code{TRUE}, returns Python model. Default \code{TRUE}.}

\item{epochs}{Integer initial training epochs. Default \code{500}.}

\item{initial_lr}{Numeric initial learning rate. Default \code{0.01}.}

\item{decay_factor}{Numeric learning rate decay. Default \code{0.999}.}

\item{beta}{Numeric KL weight. Default \code{0.001}.}

\item{max_loops}{Integer max refit loops. Default \code{100}.}

\item{patience}{Integer early stop patience. Default \code{2}.}

\item{epochs_per_loop}{Integer epochs per refit loop. Default \code{NULL} (uses \code{epochs}).}

\item{initial_lr_refit}{Numeric LR for refit loops. Default \code{NULL}.}

\item{decay_factor_refit}{Numeric decay for refit loops. Default \code{NULL}.}

\item{beta_refit}{Numeric KL weight for refit loops. Default \code{NULL}.}

\item{verbose}{Logical; if \code{TRUE}, prints progress. Default \code{FALSE}.}

\item{return_silhouettes}{Logical; if \code{TRUE}, returns silhouette scores. Default \code{FALSE}.}
}
\value{
A list with elements:
\itemize{
\item \code{imputed}: data.frame of imputed values (with \code{index_col} re-attached).
\item \code{model}: Python VAE object (if \code{return_model = TRUE}).
\item \code{silhouettes}: numeric vector (if \code{return_silhouettes = TRUE}).
}
}
\description{
Wraps the Python \code{run_cissvae} function from the \code{ciss_vae} module,
handles an optional \code{index_col}, and returns imputed data,
and optionally the model and silhouette scores.
}
